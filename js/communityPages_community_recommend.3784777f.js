(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{"264":function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(2),a=n(274),o=n(6),c=n(598),i=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var l=function(e){function BackTop(){return function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BackTop),function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(BackTop.__proto__||Object.getPrototypeOf(BackTop)).apply(this,arguments))}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(BackTop,o["a"].Component),i(BackTop,[{"key":"render","value":function render(){return r.l.createElement(c.a,null,r.l.createElement(c.a,{"style":"bottom:15%;","onClick":function onClick(){return function toTop(){Object(a.a)({"scrollTop":0,"duration":500})}()},"className":"back-top"}))}}]),BackTop}();l.options={"addGlobalClass":!0}},"274":function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),a=void 0,o=void 0,c=function pageScrollTo(e){var t=e.scrollTop,n=e.duration,c=void 0===n?300:n,i=e.success,l=e.fail,s=e.complete;return new Promise(function(e,n){try{if(void 0===t)throw Error('"scrollTop" is required');var u=document.querySelector(".taro-tabbar__panel")||window;a||(a=u===window?function scrollFunc(e){if(void 0===e)return window.pageYOffset;window.scrollTo(0,e)}:function scrollFunc(e){if(void 0===e)return u.scrollTop;u.scrollTop=e});var m=a(),d=t-m,p=c/17,f=Object(r.g)(r.c,p);!function scroll(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=m+d*f(t);if(a(n),t<p)o&&clearTimeout(o),o=setTimeout(function(){scroll(t+1)},17);else{var r={"errMsg":"pageScrollTo:ok"};i&&i(r),s&&s(),e(r)}}()}catch(e){var b={"errMsg":"pageScrollTo:fail "+e.message};l&&l(b),s&&s(),n(b)}})}},"287":function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"h",function(){return c}),n.d(t,"i",function(){return i}),n.d(t,"j",function(){return l}),n.d(t,"a",function(){return s}),n.d(t,"k",function(){return u}),n.d(t,"d",function(){return m}),n.d(t,"c",function(){return d}),n.d(t,"l",function(){return p}),n.d(t,"g",function(){return f}),n.d(t,"f",function(){return b}),n.d(t,"m",function(){return y}),n.d(t,"b",function(){return g});var r=n(3),a=n(5),o=function loadBullentins(e){return r.a.httpGql(a.x,e,!0)},c=function loadContributions(e){return r.a.httpGql(a.E,e,!0)},i=function loadDonations(e){return r.a.httpGql(a.Q,e,!0)},l=function loadDonayionsForCity(e){return r.a.httpGql(a.R,e)},s=function getGroupExceptService(){return r.a.get("wechat_method/group/no_service")},u=function loadSiteApplys(e){return r.a.httpGql(a.Ib,e)},m=function loadBullentinDetail(e){return r.a.httpGql(a.w,e,!0)},d=function loadBullentinActivitys(e){return r.a.httpGql(a.y,e,!0)},p=function loadSiteDetail(e){return r.a.httpGql(a.Jb,e,!0)},f=function loadCommunityStyle(e){return r.a.httpGql(a.D,e,!0)},b=function loadCommunitySites(e){return r.a.httpGql(a.C,e,!0)},y=function postMyReservation(e){return r.a.post("site_apply",e)},g=function getMyResidents(e){return r.a.httpGql(a.kb,e)}},"304":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAICAYAAADwdn+XAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABZ0RVh0Q3JlYXRpb24gVGltZQAwNC8wMS8xOTLpLfMAAAAcdEVYdFNvZnR3YXJlAEFkb2JlIEZpcmV3b3JrcyBDUzbovLKMAAAAQ0lEQVQokaWOsREAIAgDA/tmGRbWykIUUaTiSP4PMbOGj1GSUoVJio6lAgOA+sMLPAluJb6jWSHLFkFUjMRbgQdOX3WFZxS1gbyl/wAAAABJRU5ErkJggg=="},"311":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAACXBIWXMAAAsTAAALEwEAmpwYAAAF+mlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTEyLTIxVDE0OjIwOjM5KzA4OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMC0wNS0yOVQxNDozNDoxNiswODowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMC0wNS0yOVQxNDozNDoxNiswODowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3MTk5OGI5OS1iOGZjLTI0NDQtOWMwMS1lMjI2N2QwODkwNzkiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpiMDYyYmE1Ny01ZTA2LWYxNDUtYjlkYy1mODM5NzhjM2I5NzQiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1YzQyNDc4Ni04MGVlLTA2NGYtOThmYS05MWE5MzU0ZTg4ZGYiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjVjNDI0Nzg2LTgwZWUtMDY0Zi05OGZhLTkxYTkzNTRlODhkZiIgc3RFdnQ6d2hlbj0iMjAxOS0xMi0yMVQxNDoyMDozOSswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo3MTk5OGI5OS1iOGZjLTI0NDQtOWMwMS1lMjI2N2QwODkwNzkiIHN0RXZ0OndoZW49IjIwMjAtMDUtMjlUMTQ6MzQ6MTYrMDg6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5eMRjAAAAA50lEQVRIibXXSxKEIAwE0J4pzqpngtPOYsSCCCQdQzaoLJ58bMpPzhkAMv51Ym/dTrpujqZzF945X9F5NG+1Da3wCaBsxCVaAJx1xLvwIQr0Ux2NT1EJR+JLdARH4Co6g9/gJnQFe3AzqsEMTqEW2ILTKAAkA1zxiratvDahDKzhFArYplriZfCcQj1wWLHw45S5ik44Bh7tXnfCWTeX9snIDaeut2XEGuqKVw22hgONr2A2kSh8BrtikMFHsBelcAm/Rc14C0ehJrzC0aiKj/4kotAWr+jdyjWORlu8O9USnim0qzrnB/0JYnqK51SRAAAAAElFTkSuQmCC"},"347":function(e,t,n){},"645":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return w});var r=n(4),a=n.n(r),o=n(2),c=n(6),i=n(274),l=n(598),s=n(599),u=n(283),m=n(14),d=n(30),p=n(8),f=n(29),b=n(271),y=n(287),g=n(18),h=n(264),O=(n(347),n(288)),v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},A=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(a)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),k=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),_=function get(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:get(a,t,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0};function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function step(r,a){try{var o=t[r](a),c=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(c).then(function(e){step("next",e)},function(e){step("throw",e)});e(c)}("next")})}}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var w=function(e){function CommunityRecommend(){var e,t,n;!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CommunityRecommend);for(var r=arguments.length,a=Array(r),o=0;o<r;o++)a[o]=arguments[o];return t=n=_possibleConstructorReturn(this,(e=CommunityRecommend.__proto__||Object.getPrototypeOf(CommunityRecommend)).call.apply(e,[this].concat(a))),n.config={},_possibleConstructorReturn(n,t)}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(CommunityRecommend,c["a"].Component),k(CommunityRecommend,[{"key":"render","value":function render(){var e,t,r,k,_,w,x=this,C=c.a.useRouter().params,j=Object(m.u)(),E=Object(m.t)(),N=Object(p.a)("LOG_TYPE"),R=(Object(p.a)("defaultCommunityPic"),c.a.useState(!1)),I=A(R,2),S=I[0],T=I[1],M=c.a.useState([]),G=A(M,2),D=G[0],P=G[1],Y=c.a.useState({"page":1,"rows":39,"sort":"","name":"","type":["SERVICESITE","SERVICE"],"org_code":""}),Z=A(Y,2),L=Z[0],z=Z[1],B=c.a.useState(!0),W=A(B,2),F=(W[0],W[1]),Q=c.a.useState(!1),J=A(Q,2),U=J[0],H=J[1],V=c.a.useState({"id":"","name":"珠海市","code":""}),X=A(V,2),q=X[0],K=X[1],$=c.a.useState([]),ee=A($,2),te=ee[0],ne=ee[1],re=c.a.useState("district"),ae=A(re,2),oe=ae[0],ce=(ae[1],c.a.useRef("")),ie=c.a.useState([]),le=A(ie,2),se=le[0],ue=le[1],me=c.a.useState("全部机构"),de=A(me,2),pe=de[0],fe=de[1],be=c.a.useState("focus"),ye=A(be,2),ge=ye[0],he=ye[1],Oe=c.a.useState([]),ve=A(Oe,2),Ae=ve[0],ke=ve[1],_e=c.a.useState(E),we=A(_e,2),xe=we[0],Ce=we[1],je=function loadGroups(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(L.page=1,z(L),P([])),Object(d.o)(L,!0)},Ee=function getMyResidentsIds(e,t){var n=[];return t&&t.length>0&&t.forEach(function(e){e=e.node&&e.node.group||e,n.push(e.id)}),n},Ne=(e=_asyncToGenerator(a.a.mark(function _callee(){var e,t,n,r;return a.a.wrap(function _callee$(a){for(;;)switch(a.prev=a.next){case 0:if("机构"!==L.name&&"村"!==L.name&&"组织"!==L.name){a.next=4;break}return a.next=3,Object(f.c)("请输入有效的关键字查询");case 3:return a.abrupt("return");case 4:return e=[],"myResidents"!==ce.current&&(e=Ee(0,xe)),t={},n=[],a.next=10,je(!0);case 10:t=a.sent,n=t.groups.edges||[],r=[],n.forEach(function(t){var n=t.node;if(n){var a=n.id;if(n.logos.length>0)for(var o=0;o<n.logos.length;o++)n.picture=Object(m.w)(n.logos[0].url);var c=e.indexOf(a);n.joined=c>-1,r.push(n)}}),P([].concat(r)),ue([]),ke([]),L.name?fe("搜索结果"):fe("全部机构"),Object(m.F)(N.CLICK_COMMUNITY_SEARCH);case 19:case"end":return a.stop()}},_callee,x)})),function search(){return e.apply(this,arguments)}),Re=(t=_asyncToGenerator(a.a.mark(function _callee2(){var e,t,n,r,o;return a.a.wrap(function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:return e="",L.name=e,z(L),t=[],"myResidents"!==ce.current&&(t=Ee(0,xe)),n={},r=[],a.next=9,je(!0);case 9:n=a.sent,r=n.groups.edges||[],o=[],r.forEach(function(e){var n=e.node;if(n){var r=n.id;if(n.logos.length>0)for(var a=0;a<n.logos.length;a++)n.picture=Object(m.w)(n.logos[0].url);var c=t.indexOf(r);n.joined=c>-1,o.push(n)}}),P([].concat(o)),ue([]),ke([]),fe("全部机构");case 17:case"end":return a.stop()}},_callee2,x)})),function cleanSearch(){return t.apply(this,arguments)}),Ie=(r=_asyncToGenerator(a.a.mark(function _callee3(e){var t,n,r,o,c,i,l,s,u,d,p;return a.a.wrap(function _callee3$(a){for(;;)switch(a.prev=a.next){case 0:if(t=e.valueList,!((n=t.length)>0)){a.next=27;break}if(r=t[n-1].value,o=r.split("="),!(Array.isArray(o)&&o.length>0)){a.next=27;break}return c=o[0],i=o[1],l=o[2],q.id=c,q.name=i,K(q),s=Ee(0,xe),L.org_code=l,z(L),u={},d=[],a.next=19,je(!0);case 19:u=a.sent,d=u.groups.edges||[],p=[],d.forEach(function(e){var t=e.node;if(t){var n=t.id;if(t.logos.length>0)for(var r=0;r<t.logos.length;r++)t.picture=Object(m.w)(t.logos[0].url);var a=s.indexOf(n);t.joined=a>-1,p.push(t)}}),P([].concat(p)),ue([]),ke([]),fe("筛选结果");case 27:case"end":return a.stop()}},_callee3,x)})),function cascaderChange(e){return r.apply(this,arguments)}),Se=function updateDataStatus(e,t,n){return e.filter(function(e){return e.id===t&&(e.joined=n),!0})},Te=(k=_asyncToGenerator(a.a.mark(function _callee4(e,t){var n,r,o,i,l,s,u,d,p;return a.a.wrap(function _callee4$(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.id,r=e.simple_name||e.name,o=j.uid,"focus"!==ge){a.next=67;break}if("myResidents"===ce.current){a.next=26;break}return[],xe&&xe.length>0&&xe.filter(function(e){return e.type}),i={"uid":o,"org_id":n},a.next=10,Object(g.v)(i);case 10:if(0!==(l=a.sent).code){a.next=23;break}return Object(f.c)("关注成功"),"dataList"===t?P(Se(D,n,!1)):"nearOrgs"===t?ue(Se(se,n,!1)):"focusSrv"===t&&ue(Se(Ae,n,!1)),e.joined=!0,Ce(function(t){return[].concat(_toConsumableArray(t),[e])}),a.next=18,Object(m.O)(o);case 18:return a.next=20,Object(m.N)({"page":1,"rows":100,"uid":j.uid});case 20:Object(m.F)(N.CLICK_FOCUS_COMMUNITY,{"op_type":N.OP_TYPE_COMMUNITY||"","business_id":n||""}),a.next=24;break;case 23:Object(f.c)(l.data);case 24:a.next=65;break;case 26:return j.org_id=n,j.org_name=r,s=v({},j),s=Object(m.x)(s),a.next=32,Object(g.B)(s);case 32:return u=a.sent,d={"uid":o,"org_id":n},a.next=36,Object(g.v)(d);case 36:if(p=a.sent,0!==u.code){a.next=64;break}if(0!==p.code){a.next=50;break}return a.next=41,Object(f.c)("设置成功, 请耐心等待管理员审核");case 41:return"dataList"===t?P(Se(D,n,!1)):"nearOrgs"===t?ue(Se(se,n,!1)):"focusSrv"===t&&ue(Se(Ae,n,!1)),Object(m.F)(N.CLICK_SET_RESIDENT_COMMUNITY,{"op_type":N.OP_TYPE_COMMUNITY||"","business_id":n||""}),a.next=45,Object(m.O)(o);case 45:return a.next=47,Object(m.N)({"page":1,"rows":100,"uid":j.uid});case 47:c.a.navigateBack({"delta":1}),a.next=62;break;case 50:if("不能重复加入！"!==p.data){a.next=61;break}return a.next=53,Object(f.c)("设置成功, 请耐心等待管理员审核");case 53:return a.next=55,Object(m.O)(o);case 55:return a.next=57,Object(m.N)({"page":1,"rows":100,"uid":j.uid});case 57:Object(m.F)(N.CLICK_SET_RESIDENT_COMMUNITY,{"op_type":N.OP_TYPE_COMMUNITY||"","business_id":n||""}),c.a.navigateBack({"delta":1}),a.next=62;break;case 61:Object(f.c)(p.data);case 62:a.next=65;break;case 64:Object(f.c)(u.data);case 65:a.next=68;break;case 67:Object(m.B)("/communityPages/pages/community_style?id="+n+"&org_name="+r);case 68:case"end":return a.stop()}},_callee4,x)})),function joinCommunity(e,t){return k.apply(this,arguments)}),Me=(_=_asyncToGenerator(a.a.mark(function _callee5(e,t,n){var r,o,c,i,l;return a.a.wrap(function _callee5$(a){for(;;)switch(a.prev=a.next){case 0:if("focus"!==ge){a.next=31;break}if(r="机构","myResidents"===ce.current){a.next=28;break}if(e!==j.org_id){a.next=7;break}return Object(f.c)("该"+r+"是当前常驻"+r+"，不能取消关注"),a.abrupt("return");case 7:return o=j.uid,c={"uid":o,"org_id":e},a.next=11,Object(g.d)(c);case 11:if(0!==(i=a.sent).code){a.next=25;break}return Object(f.c)("取消关注成功"),"dataList"===n?P(Se(D,e,!1)):"nearOrgs"===n?ue(Se(se,e,!1)):"focusSrv"===n&&ue(Se(Ae,e,!1)),l=(l=[].concat(_toConsumableArray(xe))).filter(function(t){return t.id!==e}),Ce([].concat(_toConsumableArray(l))),a.next=20,Object(m.O)(o);case 20:return a.next=22,Object(m.N)({"page":1,"rows":100,"uid":j.uid});case 22:Object(m.F)(N.CLICK_UNFOCUS_COMMUNITY,{"op_type":N.OP_TYPE_COMMUNITY||"","business_id":e||""}),a.next=26;break;case 25:Object(f.c)(i.data);case 26:a.next=29;break;case 28:Object(f.c)("已是常驻"+r+"，更换请选择其他"+r);case 29:a.next=32;break;case 31:Object(m.B)("/communityPages/pages/community_style?id="+t.id+"&org_name="+t.name);case 32:case"end":return a.stop()}},_callee5,x)})),function quitCommunity(e,t,n){return _.apply(this,arguments)}),Ge=(w=_asyncToGenerator(a.a.mark(function _callee6(e){return a.a.wrap(function _callee6$(t){for(;;)switch(t.prev=t.next){case 0:Object(m.B)("/communityPages/pages/community_style?id="+e.id+"&org_name="+e.name);case 1:case"end":return t.stop()}},_callee6,x)})),function showDetail(e){return w.apply(this,arguments)}),De=c.a.useRef(0);c.a.usePageScroll(function(e){De.current=e.scrollTop;var t=e.scrollTop;T(t>500)});var Pe,Ye=(Pe=_asyncToGenerator(a.a.mark(function _callee7(){var e,t,n,r,o,c,i,l,s,u,d,p;return a.a.wrap(function _callee7$(a){for(;;)switch(a.prev=a.next){case 0:if("show"===C.action){a.next=7;break}return a.next=3,Object(m.z)(0);case 3:if(0===(e=a.sent)){a.next=7;break}return Object(m.v)(e,{"nextUrl":"/communityPages/pages/community_recommend"}),a.abrupt("return");case 7:return Object(f.a)(!0),ce.current=C.type||"",he(C.action||"focus"),a.next=12,Object(m.p)();case 12:if(t=a.sent,q.id=t.org_id,q.name=t.org_name,q.code=t.org_code,L.org_code=t.org_code,L.city_id=t.org_id,z(function(e){return v({},e,L)}),K(q),n=[],r=[],o=[],c={},"index"!==C.from){a.next=31;break}return a.next=27,je(!0);case 27:c=a.sent,o=c.groups.edges||[],a.next=35;break;case 31:return a.next=33,Object(y.b)({"uid":j.uid,"page":1,"rows":100});case 33:c=a.sent,o=c.my_residents&&c.my_residents.edges||[];case 35:return i=[],o.forEach(function(e){var t=e.node&&e.node.group;t&&(t.joined=!0,i.push(t),"myResidents"===C.type&&(C.orgId===t.id?t.joined=!0:t.joined=!1),n.push(t))}),Ce([].concat(i)),l=[],l="myResidents"===C.type?[C.orgId]:Ee(C.category,o),s=[],a.next=43,Object(m.n)();case 43:return(u=a.sent).length>0&&u.forEach(function(e){var t=e.id;e.logos.length>0&&-1===e.logos[0].url.indexOf("http://")&&-1===e.logos[0].url.indexOf("https://")&&(e.picture=Object(m.w)(e.logos[0].url));var n=l.indexOf(t);e.joined=n>-1,s.push(e)}),ue(s),a.next=48,Object(y.a)();case 48:if(0===(d=a.sent).code&&(p=d.data,ne(Object(b.e)(p))),P([].concat(n)),!(r.length<1&&n.length<1&&s.length<1)){a.next=54;break}return a.next=54,Ne();case 54:Object(f.a)(!1);case 55:case"end":return a.stop()}},_callee7,x)})),function onload(){return Pe.apply(this,arguments)}),Ze=c.a.useRef(function(){}),Le=c.a.useRef(0);c.a.useReachBottom(_asyncToGenerator(a.a.mark(function _callee8(){var e;return a.a.wrap(function _callee8$(t){for(;;)switch(t.prev=t.next){case 0:if(!x.pageHide){t.next=2;break}return t.abrupt("return");case 2:if(!((e=document.documentElement.scrollTop||document.body.scrollTop)<Le.current)){t.next=8;break}return Le.current=e,t.abrupt("return");case 8:Le.current=e;case 9:Ze.current()&&Be();case 11:case"end":return t.stop()}},_callee8,x)})));var ze,Be=(ze=_asyncToGenerator(a.a.mark(function _callee9(){var e,t,n,r;return a.a.wrap(function _callee9$(a){for(;;)switch(a.prev=a.next){case 0:return e=[],"myResidents"!==ce.current&&(e=Ee(0,xe)),L.page+=1,z(L),t={},n=[],a.next=8,je();case 8:t=a.sent,n=t.groups.edges||[],r=[],n.forEach(function(t){var n=t.node;if(n){var a=n.id;if(n.logos.length>0)for(var o=0;o<n.logos.length;o++)n.picture=Object(m.w)(n.logos[0].url);var c=e.indexOf(a);n.joined=c>-1,r.push(n)}}),r.length<=0&&F(!1),P([].concat(_toConsumableArray(D),r));case 14:case"end":return a.stop()}},_callee9,x)})),function reachBottom(){return ze.apply(this,arguments)});c.a.useDidShow(function(){Object(i.a)({"scrollTop":We.current,"duration":100}),Object(m.L)("机构列表"),x.pageHide=!1,Ze.current=Object(m.Q)()});var We=c.a.useRef(0);return c.a.useDidHide(function(){We.current=De.current,x.pageHide=!0}),c.a.useEffect(function(){Ye()},[]),o.l.createElement(l.a,{"className":"content fix"},o.l.createElement(l.a,{"className":"my-shequ"},o.l.createElement(l.a,{"className":"new-head-search clear"},o.l.createElement(l.a,{"className":"clean clear","style":"right: 20%;","onClick":function onClick(){return Re()}},o.l.createElement(s.a,{"className":"img","src":n(311)})),o.l.createElement(l.a,{"className":"search-filter left","onClick":function onClick(){return function openCascader(){H(!0)}()}},o.l.createElement(l.a,{"className":"search-filter-main"},o.l.createElement(l.a,{"className":"search-filter-txt"},q.name||"珠海市"),o.l.createElement(s.a,{"src":n(304),"style":"width:9.8px;height:4.89px;","className":"image"}))),o.l.createElement(O.a,{"isOpened":U,"dataSource":te,"label":"label","onClose":function onClose(e){return function closeCascader(e){Ie(e),H(!1)}(e)}}),o.l.createElement(u.a,{"onInput":function inputChange(e){L.name=e.detail.value||"",z(L)}.bind(this),"className":"input-search left","style":"border-radius: 0 20px 20px 0;","placeholder":"搜索","value":L.name}),o.l.createElement(l.a,{"className":"search-btn left","onClick":function onClick(){return Ne()}})),"district"===oe&&!!se&&se.length>0&&o.l.createElement(l.a,{"className":"main-con no-padding margin"},o.l.createElement(l.a,{"className":"title-fixed"},"附近的机构"),o.l.createElement(l.a,{"className":"comunity-list padding-l-r clear"},se.map(function(e){return e.joined?o.l.createElement(l.a,{"className":"list-h border-bottom flex","key":e.id},o.l.createElement(l.a,{"className":"grid8 control-2line","style":"-webkit-box-orient: vertical;","onClick":function onClick(){return Ge(e)}},e.simple_name||e.name),"show"!==ge&&o.l.createElement(l.a,{"className":"grid2"},o.l.createElement(l.a,{"className":"border-blue text-blue radius3 font14 text-center","onClick":function onClick(){return Me(e.id,e,"nearOrgs")}},"取消"))):o.l.createElement(l.a,{"className":"list-h border-bottom ","key":e.id},o.l.createElement(l.a,{"className":"grid8 control-2line","style":"-webkit-box-orient: vertical;","onClick":function onClick(){return Ge(e)}},e.simple_name||e.name),"show"!==ge&&o.l.createElement(l.a,{"className":"grid2"},o.l.createElement(l.a,{"className":"blue-bg text-white radius3  font14 text-center","onClick":function onClick(){return Te(e,"nearOrgs")}},"关注")))}))),o.l.createElement(l.a,{"className":"box"},!!D&&D.length>0&&o.l.createElement(l.a,{"className":"main-con no-padding margin"},o.l.createElement(l.a,{"className":"title-fixed"},pe),o.l.createElement(l.a,{"className":"comunity-list padding-l-r clear"},D.map(function(e){return e.joined?o.l.createElement(l.a,{"className":"list-h border-bottom flex","key":e.id},o.l.createElement(l.a,{"className":"grid8 control-2line","style":"-webkit-box-orient: vertical;","onClick":function onClick(){return Ge(e)}},e.simple_name||e.name),"show"!==ge&&o.l.createElement(l.a,{"className":"grid2"},o.l.createElement(l.a,{"className":"border-blue text-blue radius3 font14 text-center","onClick":function onClick(){return Me(e.id,e,"dataList")}},"取消"))):o.l.createElement(l.a,{"className":"list-h border-bottom flex","key":e.id},o.l.createElement(l.a,{"className":"grid8 control-2line","style":"-webkit-box-orient: vertical;","onClick":function onClick(){return Ge(e)}},e.simple_name||e.name),"show"!==ge&&o.l.createElement(l.a,{"className":"grid2"},o.l.createElement(l.a,{"className":"blue-bg text-white  radius3 font14 text-center","onClick":function onClick(){return Te(e,"dataList")}},"关注")))})))),o.l.createElement(l.a,{"className":"box"},("all"===oe||"service"===oe)&&!!Ae&&Ae.length>0&&o.l.createElement(l.a,{"className":"main-con no-padding margin"},o.l.createElement(l.a,{"className":"title-fixed"},"关注的社会机构"),o.l.createElement(l.a,{"className":"comunity-list padding-l-r clear"},Ae.map(function(e){return e.joined?o.l.createElement(l.a,{"className":"list-h border-bottom flex","key":e.id},o.l.createElement(l.a,{"className":"grid8 control-2line","style":"-webkit-box-orient: vertical;","onClick":function onClick(){return Ge(e)}},e.simple_name||e.name),"show"!==ge&&o.l.createElement(l.a,{"className":"grid2"},o.l.createElement(l.a,{"className":"border-blue text-blue  radius3  font14 text-center","onClick":function onClick(){return Me(e.id,e,"focusSrv")}},"取消"))):o.l.createElement(l.a,{"className":"list-h border-bottom ","key":e.id},o.l.createElement(l.a,{"className":"grid8 control-2line","style":"-webkit-box-orient: vertical;","onClick":function onClick(){return Ge(e)}},e.simple_name||e.name),"show"!==ge&&o.l.createElement(l.a,{"className":"grid2"},o.l.createElement(l.a,{"className":"blue-bg text-white  radius3  font14 text-center","onClick":function onClick(){return Te(e,"focusSrv")}},"关注")))})))),!D||0===D.length&&o.l.createElement(l.a,{"style":"margin-top:50px;","className":"i-className i-load-more i-load-more-line"},o.l.createElement(l.a,{"className":"i-load-more-tip"},o.l.createElement(l.a,null,"暂无内容")))),S&&o.l.createElement(h.a,null))}},{"key":"componentDidMount","value":function componentDidMount(){_(CommunityRecommend.prototype.__proto__||Object.getPrototypeOf(CommunityRecommend.prototype),"componentDidMount",this)&&_(CommunityRecommend.prototype.__proto__||Object.getPrototypeOf(CommunityRecommend.prototype),"componentDidMount",this).call(this)}},{"key":"componentDidShow","value":function componentDidShow(){_(CommunityRecommend.prototype.__proto__||Object.getPrototypeOf(CommunityRecommend.prototype),"componentDidShow",this)&&_(CommunityRecommend.prototype.__proto__||Object.getPrototypeOf(CommunityRecommend.prototype),"componentDidShow",this).call(this)}},{"key":"componentDidHide","value":function componentDidHide(){_(CommunityRecommend.prototype.__proto__||Object.getPrototypeOf(CommunityRecommend.prototype),"componentDidHide",this)&&_(CommunityRecommend.prototype.__proto__||Object.getPrototypeOf(CommunityRecommend.prototype),"componentDidHide",this).call(this)}}]),CommunityRecommend}();w.config={}}}]);