(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{"264":function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(2),o=n(274),a=n(6),c=n(598),i=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var l=function(e){function BackTop(){return function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BackTop),function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(BackTop.__proto__||Object.getPrototypeOf(BackTop)).apply(this,arguments))}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(BackTop,a["a"].Component),i(BackTop,[{"key":"render","value":function render(){return r.l.createElement(c.a,null,r.l.createElement(c.a,{"style":"bottom:15%;","onClick":function onClick(){return function toTop(){Object(o.a)({"scrollTop":0,"duration":500})}()},"className":"back-top"}))}}]),BackTop}();l.options={"addGlobalClass":!0}},"274":function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),o=void 0,a=void 0,c=function pageScrollTo(e){var t=e.scrollTop,n=e.duration,c=void 0===n?300:n,i=e.success,l=e.fail,s=e.complete;return new Promise(function(e,n){try{if(void 0===t)throw Error('"scrollTop" is required');var u=document.querySelector(".taro-tabbar__panel")||window;o||(o=u===window?function scrollFunc(e){if(void 0===e)return window.pageYOffset;window.scrollTo(0,e)}:function scrollFunc(e){if(void 0===e)return u.scrollTop;u.scrollTop=e});var p=o(),m=t-p,f=c/17,d=Object(r.g)(r.c,f);!function scroll(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=p+m*d(t);if(o(n),t<f)a&&clearTimeout(a),a=setTimeout(function(){scroll(t+1)},17);else{var r={"errMsg":"pageScrollTo:ok"};i&&i(r),s&&s(),e(r)}}()}catch(e){var y={"errMsg":"pageScrollTo:fail "+e.message};l&&l(y),s&&s(),n(y)}})}},"304":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAICAYAAADwdn+XAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABZ0RVh0Q3JlYXRpb24gVGltZQAwNC8wMS8xOTLpLfMAAAAcdEVYdFNvZnR3YXJlAEFkb2JlIEZpcmV3b3JrcyBDUzbovLKMAAAAQ0lEQVQokaWOsREAIAgDA/tmGRbWykIUUaTiSP4PMbOGj1GSUoVJio6lAgOA+sMLPAluJb6jWSHLFkFUjMRbgQdOX3WFZxS1gbyl/wAAAABJRU5ErkJggg=="},"347":function(e,t,n){},"650":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return A});var r=n(4),o=n.n(r),a=n(2),c=n(6),i=n(274),l=n(598),s=n(599),u=n(283),p=n(14),m=n(30),f=n(8),d=n(29),y=n(271),b=n(264),h=(n(347),n(288)),g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},v=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&i.return&&i.return()}finally{if(o)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),w=function get(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:get(o,t,n)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(n):void 0};function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function step(r,o){try{var a=t[r](o),c=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(c).then(function(e){step("next",e)},function(e){step("throw",e)});e(c)}("next")})}}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var A=function(e){function CommunitySites(){var e,t,n;!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CommunitySites);for(var r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=n=_possibleConstructorReturn(this,(e=CommunitySites.__proto__||Object.getPrototypeOf(CommunitySites)).call.apply(e,[this].concat(o))),n.config={},_possibleConstructorReturn(n,t)}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(CommunitySites,c["a"].Component),_(CommunitySites,[{"key":"render","value":function render(){var e=this,t=Object(f.a)("defaultCommunityPic"),r=c.a.useState(!1),_=v(r,2),w=_[0],A=_[1],O=c.a.useState([]),C=v(O,2),E=C[0],S=C[1],k=c.a.useState({"page":1,"rows":10,"sort":"","order":"","search_param":"","org_id":""}),j=v(k,2),P=j[0],T=j[1],x=c.a.useState(!0),N=v(x,2),R=N[0],D=N[1],B=c.a.useState(!1),M=v(B,2),F=M[0],G=M[1],I=c.a.useState({"id":"","name":"珠海市"}),H=v(I,2),J=H[0],U=H[1],L=c.a.useState([]),Q=v(L,2),V=Q[0],W=Q[1],Y=c.a.useRouter().params,Z=0;Object(p.z)(0).then(function(e){Z=e});var X,$=(X=_asyncToGenerator(o.a.mark(function _callee(){var n,r,a,c,i,l,s,u,f=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return o.a.wrap(function _callee$(e){for(;;)switch(e.prev=e.next){case 0:return f&&(P.page=1,T(P),S([])),e.next=3,Object(m.t)(P);case 3:if(n=e.sent,r=n.volunteer_sites_to_city.edges||[],a=parseInt(n.volunteer_sites_to_city.toatlCount)||0,P.page*P.rows>=a?D(!1):D(!0),c=[],r.length>0)for(i=0;i<r.length;i++){if((l=r[i].node).vsPic&&l.vsPic.length>0){for(s=0;s<l.vsPic.length;s++)(u=l.vsPic[s]).url=Object(p.w)(u.url);l.picture=l.vsPic[0].url}else l.picture=t;c.push(l)}S(f?c:[].concat(_toConsumableArray(E),c));case 10:case"end":return e.stop()}},_callee,e)})),function loadData(){return X.apply(this,arguments)}),z=function toDetail(e){Object(p.B)("/communityPages/pages/community_site_detail?id="+e.id)},q=function closeCascader(e){!function cascaderChange(e){var t=e.valueList,n=t.length;if(n>0){var r=t[n-1].value.split("=");if(Array.isArray(r)&&r.length>0){var o=r[0],a=r[1];J.id=o,J.name=a,P.org_id=o,T(P),U(J)}}$(!0)}(e),G(!1)},K=c.a.useRef(0);c.a.usePageScroll(function(e){K.current=e.scrollTop;var t=e.scrollTop;A(t>500)});var ee,te=(ee=_asyncToGenerator(o.a.mark(function _callee2(){var t,n,r;return o.a.wrap(function _callee2$(e){for(;;)switch(e.prev=e.next){case 0:if(0===Z){e.next=3;break}return Object(p.v)(Z,{"nextUrl":"/communityPages/pages/community_sites"}),e.abrupt("return");case 3:return Object(d.a)(!0),e.next=6,Object(p.p)();case 6:return t=e.sent,J.id=t.org_id,J.name=t.org_name,n=Y.id||t.org_id,P.org_id=n,T(P),$(!0),e.next=15,Object(p.l)();case 15:r=e.sent,W(Object(y.e)(r,"TOWN")),Object(d.a)(!1);case 18:case"end":return e.stop()}},_callee2,e)})),function onload(){return ee.apply(this,arguments)}),ne=c.a.useRef(function(){}),re=c.a.useRef(0);c.a.useReachBottom(_asyncToGenerator(o.a.mark(function _callee3(){var t;return o.a.wrap(function _callee3$(n){for(;;)switch(n.prev=n.next){case 0:if(!e.pageHide){n.next=2;break}return n.abrupt("return");case 2:if(!((t=document.documentElement.scrollTop||document.body.scrollTop)<re.current)){n.next=8;break}return re.current=t,n.abrupt("return");case 8:re.current=t;case 9:ne.current()&&ae();case 11:case"end":return n.stop()}},_callee3,e)})));var oe,ae=(oe=_asyncToGenerator(o.a.mark(function _callee4(){return o.a.wrap(function _callee4$(e){for(;;)switch(e.prev=e.next){case 0:if(!R){e.next=5;break}return P.page+=1,T(function(e){return g({},e,P)}),e.next=5,$();case 5:case"end":return e.stop()}},_callee4,e)})),function reachBottom(){return oe.apply(this,arguments)});c.a.useDidShow(function(){Object(i.a)({"scrollTop":ce.current,"duration":100}),Object(p.L)("热门场所"),e.pageHide=!1,ne.current=Object(p.Q)()});var ce=c.a.useRef(0);return c.a.useDidHide(function(){ce.current=K.current,e.pageHide=!0}),c.a.useEffect(function(){te()},[]),a.l.createElement(l.a,null,a.l.createElement(l.a,{"className":"body"},a.l.createElement(l.a,{"className":"content content-nav"},a.l.createElement(l.a,{"className":"new-head-search clear"},a.l.createElement(l.a,{"className":"search-filter left","onClick":function onClick(){return function openCascader(){G(!0)}()}},a.l.createElement(l.a,{"className":"search-filter-main"},a.l.createElement(l.a,{"className":"search-filter-txt overflow"},J.name||"珠海市"),a.l.createElement(s.a,{"src":n(304),"style":"width:9.8px;height:4.89px;","className":"image"}))),a.l.createElement(h.a,{"isOpened":F,"dataSource":V,"label":"label","onClose":function onClose(e){return q(e)}}),a.l.createElement(u.a,{"onInput":function inputChange(e){P.search_param=e.detail.value||"",T(P)}.bind(this),"className":"input-search left","style":"border-radius: 0 20px 20px 0;","placeholder":"搜索","value":P.search_param}),a.l.createElement(l.a,{"className":"search-btn left","onClick":function onClick(){return function search(){S([]),P.page=1,T(P),$(!0)}()}})),a.l.createElement(l.a,{"className":"box"},!!E&&E.length>0&&a.l.createElement(a.l.Fragment,null,a.l.createElement(l.a,{"className":"recommended-community"},a.l.createElement(l.a,{"className":"recommended-community-box clear","style":"padding-top: 10px;"},a.l.createElement(l.a,{"className":"attention-community"},E.map(function(e){return a.l.createElement(l.a,{"className":"attention-community-content main-con margin-b clear","key":e.id},a.l.createElement(l.a,{"className":"detail-tags"},a.l.createElement(l.a,{"className":"detail-tags-txt"},e.org?e.org.simple_name&&e.org.name:"暂无")),a.l.createElement(l.a,{"className":"attention-community-pic left","onClick":function onClick(){return z(e)},"style":"background-image:url("+e.picture+"); position:relative;"}),a.l.createElement(l.a,{"className":"attention-community-main right"},a.l.createElement(l.a,{"className":"clear"},a.l.createElement(l.a,{"className":"h3 left overflow","style":"width: 100%;","onClick":function onClick(){return z(e)}},e.name)),a.l.createElement(l.a,{"className":"secondry-text padding-t-b overflow"},e.address||"地址不详"),a.l.createElement(l.a,{"className":"changdi-btn blue-btn-second","onClick":function onClick(){return function toReservation(e){Object(p.B)("/communityPages/pages/resource_reservation?site_name="+e.name+"&site_id="+e.id)}(e)}},"预约")))})))),R&&a.l.createElement(a.l.Fragment,null,a.l.createElement(l.a,{"style":"margin-top:50px;","className":"i-class i-load-more i-load-more-line"},a.l.createElement(l.a,{"className":"i-load-more-tip"},a.l.createElement(l.a,null,"没有更多了")))))),!E||0===E.length&&a.l.createElement(l.a,{"style":"margin-top:50px;","className":"i-class i-load-more i-load-more-line"},a.l.createElement(l.a,{"className":"i-load-more-tip"},a.l.createElement(l.a,null,"暂无内容")))),w&&a.l.createElement(b.a,null)))}},{"key":"componentDidMount","value":function componentDidMount(){w(CommunitySites.prototype.__proto__||Object.getPrototypeOf(CommunitySites.prototype),"componentDidMount",this)&&w(CommunitySites.prototype.__proto__||Object.getPrototypeOf(CommunitySites.prototype),"componentDidMount",this).call(this)}},{"key":"componentDidShow","value":function componentDidShow(){w(CommunitySites.prototype.__proto__||Object.getPrototypeOf(CommunitySites.prototype),"componentDidShow",this)&&w(CommunitySites.prototype.__proto__||Object.getPrototypeOf(CommunitySites.prototype),"componentDidShow",this).call(this)}},{"key":"componentDidHide","value":function componentDidHide(){w(CommunitySites.prototype.__proto__||Object.getPrototypeOf(CommunitySites.prototype),"componentDidHide",this)&&w(CommunitySites.prototype.__proto__||Object.getPrototypeOf(CommunitySites.prototype),"componentDidHide",this).call(this)}}]),CommunitySites}();A.config={}}}]);